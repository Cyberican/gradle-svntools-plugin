/*
 * gradlew -i publishPluginToBintray -PBINTRAY_USER=[username] -PBINTRAY_API_KEY=[api-key]
 */
plugins {
  id "java-gradle-plugin"
  id "groovy"
  id "idea"
  id "nu.studer.plugindev" version "1.0.3"
}

group = "at.bxm.gradleplugins"
version = "0.1.DEV"

plugindev {
  pluginId "at.bxm.svntools"
  pluginImplementationClass "at.bxm.gradleplugins.svntools.SvnToolsPlugin"
  pluginDescription "Provides various Subversion tasks that operate on a local SVN workspace"
  pluginLicenses "MIT"
  pluginTags "subversion", "svn", "svnkit"
  authorId "martoe"
  authorName "Martin Ehrnhoefer"
  authorEmail "martin@ehrnhoefer.com"
  projectUrl "https://github.com/martoe/gradle-svntools-plugin"
  projectInceptionYear "2014"
  done()
}

bintray {
  user = "$BINTRAY_USER"
  key = "$BINTRAY_API_KEY"
  pkg.repo = "gradle-plugins"
}

bintrayUpload.dependsOn check

dependencies {
  compile "org.codehaus.groovy:groovy-all:2.3.6"
  compile "org.tmatesoft.svnkit:svnkit:1.8.5"
  testCompile("org.spockframework:spock-core:0.7-groovy-2.0") {
    exclude group: "org.codehaus.groovy"
  }
}

if (version.endsWith("-SNAPSHOT") && project.hasProperty("ignoreTestFailures")) {
  test {
    ignoreFailures = ignoreTestFailures == "true"
  }
}
